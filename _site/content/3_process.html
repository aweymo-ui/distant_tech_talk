<!DOCTYPE html>
<html lang="en" class="h-100">
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>Process | Distant Listening, Using Python and Apps Scripts to Text Mine and Tag Oral History Collections</title>
<meta name="description" content="Article submission for Code4Lib, Summer 2024">
<meta name="keywords" content="">
<meta name="author" content="Andrew Weymouth">
<link rel="icon" type="image/png" href="http://localhost:4000/favicon.png">

<!--
  _      __         __        __           ______               __     __     
 | | /| / /__  ____/ /__ ___ / /  ___  ___/_  __/__ __ _  ___  / /__ _/ /____ 
 | |/ |/ / _ \/ __/  '_/(_-</ _ \/ _ \/ _ \/ / / -_)  ' \/ _ \/ / _ `/ __/ -_)
 |__/|__/\___/_/ /_/\_\/___/_//_/\___/ .__/_/  \__/_/_/_/ .__/_/\_,_/\__/\__/ 
                                    /_/                /_/                    

    built with workshop-template-b, evanwill, https://github.com/evanwill/workshop-template-b
--> 
   
<!-- Open Graph meta -->
<meta property="og:title" content="Process | Distant Listening, Using Python and Apps Scripts to Text Mine and Tag Oral History Collections" />
<meta property="og:type" content="website" />
<meta property="og:description" content="Article submission for Code4Lib, Summer 2024" />
<meta property="og:image" content="http://localhost:4000/images/banner.jpg" />
<meta property="og:site_name" content="Distant Listening, Using Python and Apps Scripts to Text Mine and Tag Oral History Collections" />
<meta property="og:url" content="http://localhost:4000/content/3_process.html" />
<meta property="og:locale" content="en_US" />
<!-- schema.org JSON-LD -->
<script type="application/ld+json">{ "@context":"http://schema.org", "@type":"WebPage", "headline":"Process | Distant Listening, Using Python and Apps Scripts to Text Mine and Tag Oral History Collections", "author": { "@type":"Person", "name":"Andrew Weymouth"}, "description":"Article submission for Code4Lib, Summer 2024", "image": "http://localhost:4000/images/banner.jpg", "url":"http://localhost:4000/content/3_process.html" }</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Anta&display=swap" rel="stylesheet">

<link rel="stylesheet" href="/assets/lib/spotlight.min.css">
<link rel="stylesheet" href="/assets/lib/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="/assets/css/styles.css">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap" rel="stylesheet">


<!-- Last build date: 2024-07-17 -->
  </head>

  <body class="d-flex flex-column h-100">
    <div id="skip-to-content"><a href="#maincontent">Skip to main content</a></div>
    <header>
    <nav class="navbar navbar-light pb-lg-0 border-bottom" style="background-color: #F0F8FF;">
    <div class="container">
        <h1 class="navbar-brand" style="white-space: normal;"><a href="/">
            
            Distant Listening, Using Python and Apps Scripts to Text Mine and Tag Oral History Collections
        </a></h1>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse justify-content-end" id="mainNav">
            <ul class="navbar-nav nav-tabs justify-content-end">
            
                <li class="nav-item">
                    <a class="nav-link p-3 h-100" href="/content/1_background.html">
                        
                            Background
                        
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link p-3 h-100" href="/content/2_challenges.html">
                        
                            Challenges
                        
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link active p-3 h-100" href="/content/3_process.html">
                        
                            Process
                        
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link p-3 h-100" href="/content/4_findings.html">
                        
                            Findings
                        
                    </a>
                </li>
            
                <li class="nav-item">
                    <a class="nav-link p-3 h-100" href="/content/5_references_apendices.html">
                        
                            References and Appendices
                        
                    </a>
                </li>
            
            </ul>  
        </div>
    </div>
</nav>

    </header>

    <main id="maincontent" role="main" aria-label="Content" class="flex-shrink-0">
      
      <div class="container my-4">
<h1>Process</h1>

<div class="ms-5 mb-3 border-bottom">
    </div>
    
<div class="my-4">


<p class="h6 shadow-sm p-3 about-nav sticky-top" style="background-color: #F0F8FF;">
    Contents: <a class="mx-2" href="#premiere">Premiere</a> | <a class="mx-2" href="#python-text-mining">Python Text Mining</a> | <a class="mx-2" href="#primary-tag-sheet">Primary Tag Sheet</a> | <a class="mx-2" href="#formatting">Formatting</a> | <a class="mx-2" href="#apps-script">Apps Script</a> 
</p>

<div class="symbol-container">
    <p class="symbol">&#10042;</p>
</div>

<h2 id="premiere">Premiere</h2>

<p>When I joined in fall 2023, the department was principally using a free Otter.ai account for transcription services with mixed success. Drawing from my previous experience working for a digital encyclopedia, I tested Adobe Premiere’s transcription tools and found it uniquely well-suited for the Oral History as Data framework.</p>

<p><strong>Advantages include</strong>:</p>

<ul>
  <li>
    <p>Dramatically increased accuracy in differentiating speakers and transcribing dialogue, even with obscure and regional proper nouns.</p>
  </li>
  <li>
    <p>Significantly faster transcription speed, from one 1.5-hour recording every two to three business days up to twenty 1.5-hour recordings in one day.</p>
  </li>
  <li>
    <p>Costs covered by our university-wide Adobe subscription.</p>
  </li>
  <li>
    <p>Direct export to CSV UTF-8 needed for OHD, avoiding conversion errors.</p>
  </li>
  <li>
    <p>Free non-English language packs, enabling the creation of Spanish and French language oral history collections.</p>
  </li>
  <li>
    <p>High privacy standards with Premiere’s GDPR compliance, ensuring all transcription material is stored locally and not uploaded to the cloud.[2]</p>
  </li>
</ul>

<figure class="figure d-block text-center p-3">
    <a class="spotlight" href="/images/dl_01.png"><img data-src="/images/dl_01.png" alt="Excerpt of transcript with the header names Speaker Name, Start Time, End Time and Text below a portion of sample dialogue." style="width:100%;" class="figure-img img-fluid lazyload" /></a><figcaption class="figure-caption">Example of transcript CSV formatting as it exports from Adobe Premiere</figcaption></figure>

<p>That said, the tool is not a panacea. While modern recordings in good conditions have extremely high transcription accuracy, poor quality recordings and interviews between two similar sounding people can require significant copyediting. While some negative perspectives of speech to text tools have to do with bias built into machine learning (Link, 2020), others stem from academic double standards expecting written transcripts to be an improved version of the audio rather than a reflection of it. This likely originates from the American roots of oral history transcription at Columbia University, where editors were encouraged to delete “false starts”, audit wording, rearrange passages into topical or chronological order or delete whole sections to transform the transcript from “what might be dismissed as hearsay into a document that has much the standing of legal disposition”, essentially divorcing the transcript from the audio.(Freund, 2024) Since then, critics of this practice of “cleaning up” spoken language have emerged, pointing out how it introduces unnecessary editorial bias. As University of Kentucky’s Susan Emily Allen notes in Resisting the Editorial Ego: Editing Oral History:</p>

<blockquote class="quote">
These texts take it upon themselves to glean "what words are meaningful." Meaningful for whom? For the editor? Such subjectivism is not only rather irresponsible scholarship but, however well-intentioned, an attempt to legislate truth. (Allen, 1982)
</blockquote>

<h2 id="python-text-mining">Python Text Mining</h2>

<p>After using the web based text mining tool Voyant while developing the Taylor Wilderness Research Station digital collection, I wanted to create a text mining tool from scratch using Python. This would allow the targeting of specific words and phrases, create custom tagging categories and stopwords for each collection.</p>

<p>Once the CSVs of the transcript are added to a folder in the Python workspace, the code begins with importing Pandas library for data manipulation, the Natural Language Toolkit and TextBlob for language processing and sentiment analysis. Additionally, Regular Expressions and the ‘<strong>collections.Counter</strong>’ function are added for text mining and tallying results.</p>

<p>Next, the ‘<strong>preprocess_text</strong>’ function removes words of four characters or fewer, eliminates punctuation, and converts all text to lowercase. CSV file paths are constructed, and the text data is concatenated into a single string corpus. Stopwords are removed, word frequency is counted and the 100 most frequent words are generated when the code is run.</p>

<p>Below this header material in the Python file are three categories: general, geographic and custom. These categories contains sections, which will ultimately become the tags:</p>

<ul>
  <li>
    <p><strong>General</strong>: agriculture, animals, clothing, conflict, crime, culture, economy, education, environment, family, food and drink, happiness, hardship, health, history, indigenous, labor, migration, recreation, religion, technology</p>
  </li>
  <li>
    <p><strong>Geographic (based loosely on migration statistics from the 1910 Idaho census[3])</strong>: basque, britain, canada, china, finland, france, germany, greece, idaho, india, ireland, italy, japan, mexico, norway, philippines, poland, portugal, scotland, spain, sweden</p>
  </li>
  <li>
    <p><strong>Custom (example from our Rural Women’s History Project</strong>): Marriage and Divorce, Motherhood, Reproductive Rights</p>
  </li>
</ul>

<p>Each section has a list of fifty associated words that the script is searching for within the concatenated text corpus. These were generated using Chatgpt with the following qualifications:</p>

<ul>
  <li>
    <p><strong>Specifically related to the section topic</strong> (e.g., agriculture, animals)</p>
  </li>
  <li>
    <p><strong>Exclude homographs</strong> (words that are spelled the same but have different meanings)</p>
  </li>
  <li>
    <p><strong>Place names and how certain nationalities would refer to themselves for the geographic sections</strong> (e.g., “Finnish”, “Suomalainen”, “Finland”, “Suomi”, “Helsinki”, “Espoo”, “Tampere”, “Vantaa”, “Oulu”)</p>
  </li>
</ul>

<figure class="figure d-block text-center p-3">
    <a class="spotlight" href="/images/dl_02.png"><img data-src="/images/dl_02.png" alt="Screenshot of Visual Studio Code, displaying a section with associated words around the migration tag." style="width:100%;" class="figure-img img-fluid lazyload" /></a><figcaption class="figure-caption">Complete section of the migration tag within the Python file</figcaption></figure>

<p>These produced a total of 2,250 associated words across the 45 sections. The script then tallies these words and produces the output shown below:</p>

<figure class="figure d-block text-center p-3">
    <a class="spotlight" href="/images/dl_03.png"><img data-src="/images/dl_03.png" alt=" List of tags with their associated words tallied in descending order." style="width:100%;" class="figure-img img-fluid lazyload" /></a><figcaption class="figure-caption">Example of Text Mining Tool Output for the Rural Women's History Project</figcaption></figure>

<p>Future iterations of this template will modularize the General, Geographic and Custom sections for easier navigation instead of its current form as a single, expansive Python file. See <strong>Appendix 1</strong> for an excerpt of the current iteration of this code.</p>

<h2 id="primary-tag-sheet">Primary Tag Sheet</h2>

<p>Once this text mining data is produced from the combined transcripts, it is entered into a “primary tag sheet” in Google Sheets, located in the same folder as the transcripts for student workers to edit. Using the Text to Columns function, tag names are split into column A and their associated words into column B.</p>

<figure class="figure d-block text-center p-3">
    <a class="spotlight" href="/images/dl_04.png"><img data-src="/images/dl_04.png" alt="Example of the formatted primary tags sheet with headers reading tags in column A and associated words in column B." style="width:50%;" class="figure-img img-fluid lazyload" /></a><figcaption class="figure-caption">Excerpt of a formatted primary tags sheet, utilizing the Rural Women's History Projecrt text mining tool output</figcaption></figure>

<h2 id="formatting">Formatting</h2>

<p>The student workers then open their transcription sheet to make the following changes necessary for the Oral History as Data framework, including:</p>

<ul>
  <li>Removing rows between dialogue</li>
  <li>Revising header semantics (e.g., Speaker Names to speakers, Start Time to timestamp)</li>
  <li>Adding brackets to timestamps</li>
</ul>

<figure class="figure d-block text-center p-3">
    <a class="spotlight" href="/images/dl_05.png"><img data-src="/images/dl_05.png" alt="Example of a formatted transcript sheet, with headers reading speaker, timestamp, End Time, words, tags, additions and subtractions, followed by a sample of dialogue" style="width:100%;" class="figure-img img-fluid lazyload" /></a><figcaption class="figure-caption">Example of a Formatted Transcript Sheet</figcaption></figure>

<h2 id="apps-script">Apps Script</h2>

<p>The student worker then opens the Apps Script extension on the transcription sheet and enters the code detailed in <strong>Appendix 2</strong>. Transcribers only need to make two adjustments: change the sheet name of the transcript they are editing on line 6, and the URL of their primary tag sheet on line 13, then save and run the code. This will automatically search the text for these associated words and fill in their tag name within the tag column of the transcript.</p>

<p><strong>This process is not intended to replace human transcribers but shifts the focus from manual tagging to copy editing, reducing heavy lifting and repetition</strong>. If a tag is inappropriate, the transcriber should paste it to the additions or subtractions column so these changes are preserved for future runs of the Apps Script and reflected in the final import to the OHD digital collection.</p>

<p>Crucially, student workers are encouraged to modify tag names, add or remove associated words and create new categories based on trends they identify within the primary tag sheet. Once these changes are made, the Apps Script can be quickly re-run on all transcripts to implement these updates . Rather than simply asking student workers to transcribe recordings—work that offers little to highlight on a CV and can lead to burnout and high turnover—this process allows transcribers to engage in coding, create and modify tags, and see those changes reflected instantly through the Apps Script process. Other advantages include:</p>

<ul>
  <li><strong>All tags use a controlled vocabulary.</strong></li>
  <li><strong>Tagging is more accurate, detailed, and relevant</strong>, helping researchers quickly identify thematic connections.</li>
  <li><strong>Tagging establishes a knowledge framework</strong> relevant to the collection that transcribers might lack in historical, scientific, or regional contexts key to the recordings.</li>
</ul>

<div class="symbol-container">
    <p class="symbol">&#10042;</p>
</div>


</div>

</div>
      
    </main>

    <footer class="site-footer bg-light-blue mt-auto">
  <div class="container">
    <nav class="mt-3 mb-4">
      <ul class="nav nav-pills nav-fill">
        
        <li class="nav-item"><a class="nav-link h3" href="/content/1_background.html">Background</a></li>
        
        <li class="nav-item"><a class="nav-link h3" href="/content/2_challenges.html">Challenges</a></li>
        
        <li class="nav-item"><a class="nav-link h3 active" href="/content/3_process.html">Process</a></li>
        
        <li class="nav-item"><a class="nav-link h3" href="/content/4_findings.html">Findings</a></li>
        
        <li class="nav-item"><a class="nav-link h3" href="/content/5_references_apendices.html">References and Appendices</a></li>
        
      </ul>
    </nav>
    <div class="row align-items-center pb-5">
        <div id="footer-title" class="col-md">
          <a class="h5" href="/">Distant Listening, Using Python and Apps Scripts to Text Mine and Tag Oral History Collections</a>
          <br>
          <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0, </a> 2024 <a href="https://github.com/aweymo">Andrew Weymouth</a>
        </div>
        <div class="col-md">
          
          <script>
            function site_search() {
              var query = document.getElementById("site-search").value;
              window.open("/search/index.html?q=" + encodeURIComponent(query), "_self" );
            }
          </script>
          <form class="form-inline my-2 my-lg-0 float-end" role="search" id="search" onsubmit="site_search(); return false;">
            <div class="input-group">
              <input id="site-search" class="form-control" type="text" placeholder="Search" aria-label="Search box">
              <div class="input-group-append">
                <button class="btn btn-secondary" type="submit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16"> <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/> </svg><span class="visually-hidden">submit search</span></button>
              </div>
            </div>
          </form>
          
        </div>
    </div>
  </div>
</footer>

    <!-- Bootstrap JS bundle -->
<script src="/assets/lib/bootstrap.bundle.min.js"></script>
<!-- load other optional js -->


<script src="/assets/lib/lazysizes.min.js" async></script>
<script src="/assets/lib/spotlight.min.js" defer></script>
<script>
    // When the user scrolls down from the top of the document, show the button
    window.onscroll = function () {
        if (document.body.scrollTop > 500 || document.documentElement.scrollTop > 500) {
            document.getElementById("scroll-to-top").style.display = "block";
            document.getElementById("scroll-to-top").style.color = "#00448c"; // Change button color to #00448c
        } else {
            document.getElementById("scroll-to-top").style.display = "none";
        }
    }
    // scroll to top function
    function scrollToTop() {
        window.scroll({
            top: 0, 
            left: 0, 
            behavior: 'smooth'
        });
    }
</script>
<button id="scroll-to-top" type="button" class="btn btn-link btn-lg" onclick="scrollToTop();" title="Back to Top" aria-label="Back to Top">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-square" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm8.5 9.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V11.5z"/> </svg>
</button>



  </body>

</html>